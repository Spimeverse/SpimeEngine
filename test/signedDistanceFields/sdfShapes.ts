

import { MakeSdfSphere,MakeSdfBox,MakeSdfTorus,MakeSdfCylinder } from ".."
import { SampleFieldXy, SampleFieldXz, GreyScale, NumScale, Trim } from "./SdfHelper"

export function TestSdfShapes() {
        
    describe('Signed distance fields', () => {

        it('sphere field on XY plane', () => {
            const field = MakeSdfSphere(45);
            const samples = SampleFieldXy(100,100,5,field);
            const numField = NumScale(samples);
            expect(Trim(numField)).toEqual(Trim(`
                +26  +22  +19  +16  +13  +11  +09  +07  +06  +05  +05  +05  +06  +07  +09  +11  +13  +16  +19  +22  +26
                +22  +19  +15  +12  +09  +06  +04  +02  +01  +00  +00  +00  +01  +02  +04  +06  +09  +12  +15  +19  +22
                +19  +15  +12  +08  +05  +02  -00  -02  -04  -05  -05  -05  -04  -02  -00  +02  +05  +08  +12  +15  +19
                +16  +12  +08  +04  +01  -02  -05  -07  -09  -10  -10  -10  -09  -07  -05  -02  +01  +04  +08  +12  +16
                +13  +09  +05  +01  -03  -06  -09  -11  -13  -15  -15  -15  -13  -11  -09  -06  -03  +01  +05  +09  +13
                +11  +06  +02  -02  -06  -10  -13  -16  -18  -20  -20  -20  -18  -16  -13  -10  -06  -02  +02  +06  +11
                +09  +04  -00  -05  -09  -13  -17  -20  -23  -24  -25  -24  -23  -20  -17  -13  -09  -05  -00  +04  +09
                +07  +02  -02  -07  -11  -16  -20  -24  -27  -29  -30  -29  -27  -24  -20  -16  -11  -07  -02  +02  +07
                +06  +01  -04  -09  -13  -18  -23  -27  -31  -34  -35  -34  -31  -27  -23  -18  -13  -09  -04  +01  +06
                +05  +00  -05  -10  -15  -20  -24  -29  -34  -38  -40  -38  -34  -29  -24  -20  -15  -10  -05  +00  +05
                +05  +00  -05  -10  -15  -20  -25  -30  -35  -40  -45  -40  -35  -30  -25  -20  -15  -10  -05  +00  +05
                +05  +00  -05  -10  -15  -20  -24  -29  -34  -38  -40  -38  -34  -29  -24  -20  -15  -10  -05  +00  +05
                +06  +01  -04  -09  -13  -18  -23  -27  -31  -34  -35  -34  -31  -27  -23  -18  -13  -09  -04  +01  +06
                +07  +02  -02  -07  -11  -16  -20  -24  -27  -29  -30  -29  -27  -24  -20  -16  -11  -07  -02  +02  +07
                +09  +04  -00  -05  -09  -13  -17  -20  -23  -24  -25  -24  -23  -20  -17  -13  -09  -05  -00  +04  +09
                +11  +06  +02  -02  -06  -10  -13  -16  -18  -20  -20  -20  -18  -16  -13  -10  -06  -02  +02  +06  +11
                +13  +09  +05  +01  -03  -06  -09  -11  -13  -15  -15  -15  -13  -11  -09  -06  -03  +01  +05  +09  +13
                +16  +12  +08  +04  +01  -02  -05  -07  -09  -10  -10  -10  -09  -07  -05  -02  +01  +04  +08  +12  +16
                +19  +15  +12  +08  +05  +02  -00  -02  -04  -05  -05  -05  -04  -02  -00  +02  +05  +08  +12  +15  +19
                +22  +19  +15  +12  +09  +06  +04  +02  +01  +00  +00  +00  +01  +02  +04  +06  +09  +12  +15  +19  +22
                +26  +22  +19  +16  +13  +11  +09  +07  +06  +05  +05  +05  +06  +07  +09  +11  +13  +16  +19  +22  +26`));
            const greyField = GreyScale(samples,0,25);
            expect(Trim(greyField)).toEqual(Trim(`
                |  ..,,::==++****##########****++==::,,..  |
                |..,,--==**##%%%%@@@@@@@@@@%%%%##**==--,,..|
                |,,--==**##@@@@@@@@@@@@@@@@@@@@@@##**==--,,|
                |::==**%%@@@@@@@@@@@@@@@@@@@@@@@@@@%%**==::|
                |==**##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##**==|
                |++##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##++|
                |**%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%**|
                |**%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%**|
                |##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##|
                |##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##|
                |##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##|
                |##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##|
                |##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##|
                |**%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%**|
                |**%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%**|
                |++##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##++|
                |==**##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##**==|
                |::==**%%@@@@@@@@@@@@@@@@@@@@@@@@@@%%**==::|
                |,,--==**##@@@@@@@@@@@@@@@@@@@@@@##**==--,,|
                |..,,--==**##%%%%@@@@@@@@@@%%%%##**==--,,..|
                |  ..,,::==++****##########****++==::,,..  |`));
        })

        it('sphere field on XZ plane', () => {
            debugger;
            const field = MakeSdfSphere(45);
            const samples = SampleFieldXz(100,100,5,field);
            const numField = NumScale(samples);
            expect(Trim(numField)).toEqual(Trim(`
                +26  +22  +19  +16  +13  +11  +09  +07  +06  +05  +05  +05  +06  +07  +09  +11  +13  +16  +19  +22  +26
                +22  +19  +15  +12  +09  +06  +04  +02  +01  +00  +00  +00  +01  +02  +04  +06  +09  +12  +15  +19  +22
                +19  +15  +12  +08  +05  +02  -00  -02  -04  -05  -05  -05  -04  -02  -00  +02  +05  +08  +12  +15  +19
                +16  +12  +08  +04  +01  -02  -05  -07  -09  -10  -10  -10  -09  -07  -05  -02  +01  +04  +08  +12  +16
                +13  +09  +05  +01  -03  -06  -09  -11  -13  -15  -15  -15  -13  -11  -09  -06  -03  +01  +05  +09  +13
                +11  +06  +02  -02  -06  -10  -13  -16  -18  -20  -20  -20  -18  -16  -13  -10  -06  -02  +02  +06  +11
                +09  +04  -00  -05  -09  -13  -17  -20  -23  -24  -25  -24  -23  -20  -17  -13  -09  -05  -00  +04  +09
                +07  +02  -02  -07  -11  -16  -20  -24  -27  -29  -30  -29  -27  -24  -20  -16  -11  -07  -02  +02  +07
                +06  +01  -04  -09  -13  -18  -23  -27  -31  -34  -35  -34  -31  -27  -23  -18  -13  -09  -04  +01  +06
                +05  +00  -05  -10  -15  -20  -24  -29  -34  -38  -40  -38  -34  -29  -24  -20  -15  -10  -05  +00  +05
                +05  +00  -05  -10  -15  -20  -25  -30  -35  -40  -45  -40  -35  -30  -25  -20  -15  -10  -05  +00  +05
                +05  +00  -05  -10  -15  -20  -24  -29  -34  -38  -40  -38  -34  -29  -24  -20  -15  -10  -05  +00  +05
                +06  +01  -04  -09  -13  -18  -23  -27  -31  -34  -35  -34  -31  -27  -23  -18  -13  -09  -04  +01  +06
                +07  +02  -02  -07  -11  -16  -20  -24  -27  -29  -30  -29  -27  -24  -20  -16  -11  -07  -02  +02  +07
                +09  +04  -00  -05  -09  -13  -17  -20  -23  -24  -25  -24  -23  -20  -17  -13  -09  -05  -00  +04  +09
                +11  +06  +02  -02  -06  -10  -13  -16  -18  -20  -20  -20  -18  -16  -13  -10  -06  -02  +02  +06  +11
                +13  +09  +05  +01  -03  -06  -09  -11  -13  -15  -15  -15  -13  -11  -09  -06  -03  +01  +05  +09  +13
                +16  +12  +08  +04  +01  -02  -05  -07  -09  -10  -10  -10  -09  -07  -05  -02  +01  +04  +08  +12  +16
                +19  +15  +12  +08  +05  +02  -00  -02  -04  -05  -05  -05  -04  -02  -00  +02  +05  +08  +12  +15  +19
                +22  +19  +15  +12  +09  +06  +04  +02  +01  +00  +00  +00  +01  +02  +04  +06  +09  +12  +15  +19  +22
                +26  +22  +19  +16  +13  +11  +09  +07  +06  +05  +05  +05  +06  +07  +09  +11  +13  +16  +19  +22  +26`));
            let greyField = GreyScale(samples,0,25);
            expect(Trim(greyField)).toEqual(Trim(`
                |  ..,,::==++****##########****++==::,,..  |
                |..,,--==**##%%%%@@@@@@@@@@%%%%##**==--,,..|
                |,,--==**##@@@@@@@@@@@@@@@@@@@@@@##**==--,,|
                |::==**%%@@@@@@@@@@@@@@@@@@@@@@@@@@%%**==::|
                |==**##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##**==|
                |++##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##++|
                |**%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%**|
                |**%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%**|
                |##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##|
                |##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##|
                |##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##|
                |##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##|
                |##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##|
                |**%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%**|
                |**%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%**|
                |++##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##++|
                |==**##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##**==|
                |::==**%%@@@@@@@@@@@@@@@@@@@@@@@@@@%%**==::|
                |,,--==**##@@@@@@@@@@@@@@@@@@@@@@##**==--,,|
                |..,,--==**##%%%%@@@@@@@@@@%%%%##**==--,,..|
                |  ..,,::==++****##########****++==::,,..  |`));
            greyField = GreyScale(samples,-45,0);
                expect(Trim(greyField)).toEqual(Trim(`
                |                                          |
                |                                          |
                |                  ......                  |
                |            ....,,,,,,,,,,....            |
                |          ..,,,,::::::::::,,,,..          |
                |        ..,,::::----------::::,,..        |
                |      ..,,::----====++====----::,,..      |
                |      ..,,::--==++******++==--::,,..      |
                |      ,,::--==++**######**++==--::,,      |
                |    ..,,::--==**##%%%%%%##**==--::,,..    |
                |    ..,,::--++**##%%@@%%##**++--::,,..    |
                |    ..,,::--==**##%%%%%%##**==--::,,..    |
                |      ,,::--==++**######**++==--::,,      |
                |      ..,,::--==++******++==--::,,..      |
                |      ..,,::----====++====----::,,..      |
                |        ..,,::::----------::::,,..        |
                |          ..,,,,::::::::::,,,,..          |
                |            ....,,,,,,,,,,....            |
                |                  ......                  |
                |                                          |
                |                                          |`));
        })

        it('box field on XY plane', () => {
            const field = MakeSdfBox(60,40,20);
            const samples = SampleFieldXy(100,100,5,field);
            const numField = NumScale(samples);
            expect(Trim(numField)).toEqual(Trim(`
                +36  +32  +28  +25  +22  +21  +20  +20  +20  +20  +20  +20  +20  +20  +20  +21  +22  +25  +28  +32  +36
                +34  +29  +25  +21  +18  +16  +15  +15  +15  +15  +15  +15  +15  +15  +15  +16  +18  +21  +25  +29  +34
                +32  +27  +22  +18  +14  +11  +10  +10  +10  +10  +10  +10  +10  +10  +10  +11  +14  +18  +22  +27  +32
                +30  +25  +21  +16  +11  +07  +05  +05  +05  +05  +05  +05  +05  +05  +05  +07  +11  +16  +21  +25  +30
                +30  +25  +20  +15  +10  +05  +00  +00  +00  +00  +00  +00  +00  +00  +00  +05  +10  +15  +20  +25  +30
                +30  +25  +20  +15  +10  +05  +00  -05  -05  -05  -05  -05  -05  -05  +00  +05  +10  +15  +20  +25  +30
                +30  +25  +20  +15  +10  +05  +00  -05  -10  -10  -10  -10  -10  -05  +00  +05  +10  +15  +20  +25  +30
                +30  +25  +20  +15  +10  +05  +00  -05  -10  -10  -10  -10  -10  -05  +00  +05  +10  +15  +20  +25  +30
                +30  +25  +20  +15  +10  +05  +00  -05  -10  -10  -10  -10  -10  -05  +00  +05  +10  +15  +20  +25  +30
                +30  +25  +20  +15  +10  +05  +00  -05  -10  -10  -10  -10  -10  -05  +00  +05  +10  +15  +20  +25  +30
                +30  +25  +20  +15  +10  +05  +00  -05  -10  -10  -10  -10  -10  -05  +00  +05  +10  +15  +20  +25  +30
                +30  +25  +20  +15  +10  +05  +00  -05  -10  -10  -10  -10  -10  -05  +00  +05  +10  +15  +20  +25  +30
                +30  +25  +20  +15  +10  +05  +00  -05  -10  -10  -10  -10  -10  -05  +00  +05  +10  +15  +20  +25  +30
                +30  +25  +20  +15  +10  +05  +00  -05  -10  -10  -10  -10  -10  -05  +00  +05  +10  +15  +20  +25  +30
                +30  +25  +20  +15  +10  +05  +00  -05  -10  -10  -10  -10  -10  -05  +00  +05  +10  +15  +20  +25  +30
                +30  +25  +20  +15  +10  +05  +00  -05  -05  -05  -05  -05  -05  -05  +00  +05  +10  +15  +20  +25  +30
                +30  +25  +20  +15  +10  +05  +00  +00  +00  +00  +00  +00  +00  +00  +00  +05  +10  +15  +20  +25  +30
                +30  +25  +21  +16  +11  +07  +05  +05  +05  +05  +05  +05  +05  +05  +05  +07  +11  +16  +21  +25  +30
                +32  +27  +22  +18  +14  +11  +10  +10  +10  +10  +10  +10  +10  +10  +10  +11  +14  +18  +22  +27  +32
                +34  +29  +25  +21  +18  +16  +15  +15  +15  +15  +15  +15  +15  +15  +15  +16  +18  +21  +25  +29  +34
                +36  +32  +28  +25  +22  +21  +20  +20  +20  +20  +20  +20  +20  +20  +20  +21  +22  +25  +28  +32  +36`));
            let greyField = GreyScale(samples,0,30);
            expect(Trim(greyField)).toEqual(Trim(`            
                |      ..,,::::::::::::::::::::::,,..      |
                |    ..::--======================--::..    |
                |  ..,,--==++******************++==--,,..  |
                |  ..::==++##%%%%%%%%%%%%%%%%%%##++==::..  |
                |  ..::==**%%@@@@@@@@@@@@@@@@@@%%**==::..  |
                |  ..::==**%%@@@@@@@@@@@@@@@@@@%%**==::..  |
                |  ..::==**%%@@@@@@@@@@@@@@@@@@%%**==::..  |
                |  ..::==**%%@@@@@@@@@@@@@@@@@@%%**==::..  |
                |  ..::==**%%@@@@@@@@@@@@@@@@@@%%**==::..  |
                |  ..::==**%%@@@@@@@@@@@@@@@@@@%%**==::..  |
                |  ..::==**%%@@@@@@@@@@@@@@@@@@%%**==::..  |
                |  ..::==**%%@@@@@@@@@@@@@@@@@@%%**==::..  |
                |  ..::==**%%@@@@@@@@@@@@@@@@@@%%**==::..  |
                |  ..::==**%%@@@@@@@@@@@@@@@@@@%%**==::..  |
                |  ..::==**%%@@@@@@@@@@@@@@@@@@%%**==::..  |
                |  ..::==**%%@@@@@@@@@@@@@@@@@@%%**==::..  |
                |  ..::==**%%@@@@@@@@@@@@@@@@@@%%**==::..  |
                |  ..::==++##%%%%%%%%%%%%%%%%%%##++==::..  |
                |  ..,,--==++******************++==--,,..  |
                |    ..::--======================--::..    |
                |      ..,,::::::::::::::::::::::,,..      |`));
            greyField = GreyScale(samples,-10,0);
            expect(Trim(greyField)).toEqual(Trim(`
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |              ==============              |
                |              ==@@@@@@@@@@==              |
                |              ==@@@@@@@@@@==              |
                |              ==@@@@@@@@@@==              |
                |              ==@@@@@@@@@@==              |
                |              ==@@@@@@@@@@==              |
                |              ==@@@@@@@@@@==              |
                |              ==@@@@@@@@@@==              |
                |              ==@@@@@@@@@@==              |
                |              ==@@@@@@@@@@==              |
                |              ==============              |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |`));

        })

        it('box field on XZ plane', () => {
            const field = MakeSdfBox(60,40,20);
            const samples = SampleFieldXz(100,100,5,field);
            const numField = NumScale(samples);
            expect(Trim(numField)).toEqual(Trim(`
                +45  +40  +36  +32  +28  +25  +22  +21  +20  +20  +20  +20  +20  +21  +22  +25  +28  +32  +36  +40  +45
                +43  +38  +34  +29  +25  +21  +18  +16  +15  +15  +15  +15  +15  +16  +18  +21  +25  +29  +34  +38  +43
                +41  +36  +32  +27  +22  +18  +14  +11  +10  +10  +10  +10  +10  +11  +14  +18  +22  +27  +32  +36  +41
                +40  +35  +30  +25  +21  +16  +11  +07  +05  +05  +05  +05  +05  +07  +11  +16  +21  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +10  +05  +00  +00  +00  +00  +00  +05  +10  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +10  +05  +00  -05  -05  -05  +00  +05  +10  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +10  +05  +00  -05  -10  -05  +00  +05  +10  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +10  +05  +00  -05  -10  -05  +00  +05  +10  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +10  +05  +00  -05  -10  -05  +00  +05  +10  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +10  +05  +00  -05  -10  -05  +00  +05  +10  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +10  +05  +00  -05  -10  -05  +00  +05  +10  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +10  +05  +00  -05  -10  -05  +00  +05  +10  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +10  +05  +00  -05  -10  -05  +00  +05  +10  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +10  +05  +00  -05  -10  -05  +00  +05  +10  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +10  +05  +00  -05  -10  -05  +00  +05  +10  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +10  +05  +00  -05  -05  -05  +00  +05  +10  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +10  +05  +00  +00  +00  +00  +00  +05  +10  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +21  +16  +11  +07  +05  +05  +05  +05  +05  +07  +11  +16  +21  +25  +30  +35  +40
                +41  +36  +32  +27  +22  +18  +14  +11  +10  +10  +10  +10  +10  +11  +14  +18  +22  +27  +32  +36  +41
                +43  +38  +34  +29  +25  +21  +18  +16  +15  +15  +15  +15  +15  +16  +18  +21  +25  +29  +34  +38  +43
                +45  +40  +36  +32  +28  +25  +22  +21  +20  +20  +20  +20  +20  +21  +22  +25  +28  +32  +36  +40  +45`));
            let greyField = GreyScale(samples,0,30);
            expect(Trim(greyField)).toEqual(Trim(`            
                |          ..,,::::::::::::::,,..          |
                |        ..::--==============--::..        |
                |      ..,,--==++**********++==--,,..      |
                |      ..::==++##%%%%%%%%%%##++==::..      |
                |      ..::==**%%@@@@@@@@@@%%**==::..      |
                |      ..::==**%%@@@@@@@@@@%%**==::..      |
                |      ..::==**%%@@@@@@@@@@%%**==::..      |
                |      ..::==**%%@@@@@@@@@@%%**==::..      |
                |      ..::==**%%@@@@@@@@@@%%**==::..      |
                |      ..::==**%%@@@@@@@@@@%%**==::..      |
                |      ..::==**%%@@@@@@@@@@%%**==::..      |
                |      ..::==**%%@@@@@@@@@@%%**==::..      |
                |      ..::==**%%@@@@@@@@@@%%**==::..      |
                |      ..::==**%%@@@@@@@@@@%%**==::..      |
                |      ..::==**%%@@@@@@@@@@%%**==::..      |
                |      ..::==**%%@@@@@@@@@@%%**==::..      |
                |      ..::==**%%@@@@@@@@@@%%**==::..      |
                |      ..::==++##%%%%%%%%%%##++==::..      |
                |      ..,,--==++**********++==--,,..      |
                |        ..::--==============--::..        |
                |          ..,,::::::::::::::,,..          |`));
            greyField = GreyScale(samples,-10,0);
            expect(Trim(greyField)).toEqual(Trim(`
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                  ======                  |
                |                  ==@@==                  |
                |                  ==@@==                  |
                |                  ==@@==                  |
                |                  ==@@==                  |
                |                  ==@@==                  |
                |                  ==@@==                  |
                |                  ==@@==                  |
                |                  ==@@==                  |
                |                  ==@@==                  |
                |                  ======                  |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |`));

        })        

        it('torus field on XY plane', () => {
            const field = MakeSdfTorus(30,10);
            const samples = SampleFieldXy(100,100,5,field);
            const numField = NumScale(samples);
            expect(Trim(numField)).toEqual(Trim(`
                +44  +39  +35  +30  +26  +22  +18  +15  +12  +11  +10  +11  +12  +15  +18  +22  +26  +30  +35  +39  +44
                +42  +37  +33  +28  +24  +19  +15  +11  +08  +06  +05  +06  +08  +11  +15  +19  +24  +28  +33  +37  +42
                +41  +36  +31  +26  +22  +17  +12  +08  +04  +01  +00  +01  +04  +08  +12  +17  +22  +26  +31  +36  +41
                +40  +35  +30  +25  +20  +15  +11  +06  +01  -03  -05  -03  +01  +06  +11  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +10  +05  +00  -05  -10  -05  +00  +05  +10  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +11  +06  +01  -03  -05  -03  +01  +06  +11  +15  +20  +25  +30  +35  +40
                +41  +36  +31  +26  +22  +17  +12  +08  +04  +01  +00  +01  +04  +08  +12  +17  +22  +26  +31  +36  +41
                +42  +37  +33  +28  +24  +19  +15  +11  +08  +06  +05  +06  +08  +11  +15  +19  +24  +28  +33  +37  +42
                +44  +39  +35  +30  +26  +22  +18  +15  +12  +11  +10  +11  +12  +15  +18  +22  +26  +30  +35  +39  +44
                +46  +41  +37  +33  +29  +25  +22  +19  +17  +15  +15  +15  +17  +19  +22  +25  +29  +33  +37  +41  +46
                +48  +44  +40  +36  +32  +29  +26  +24  +22  +20  +20  +20  +22  +24  +26  +29  +32  +36  +40  +44  +48
                +46  +41  +37  +33  +29  +25  +22  +19  +17  +15  +15  +15  +17  +19  +22  +25  +29  +33  +37  +41  +46
                +44  +39  +35  +30  +26  +22  +18  +15  +12  +11  +10  +11  +12  +15  +18  +22  +26  +30  +35  +39  +44
                +42  +37  +33  +28  +24  +19  +15  +11  +08  +06  +05  +06  +08  +11  +15  +19  +24  +28  +33  +37  +42
                +41  +36  +31  +26  +22  +17  +12  +08  +04  +01  +00  +01  +04  +08  +12  +17  +22  +26  +31  +36  +41
                +40  +35  +30  +25  +20  +15  +11  +06  +01  -03  -05  -03  +01  +06  +11  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +10  +05  +00  -05  -10  -05  +00  +05  +10  +15  +20  +25  +30  +35  +40
                +40  +35  +30  +25  +20  +15  +11  +06  +01  -03  -05  -03  +01  +06  +11  +15  +20  +25  +30  +35  +40
                +41  +36  +31  +26  +22  +17  +12  +08  +04  +01  +00  +01  +04  +08  +12  +17  +22  +26  +31  +36  +41
                +42  +37  +33  +28  +24  +19  +15  +11  +08  +06  +05  +06  +08  +11  +15  +19  +24  +28  +33  +37  +42
                +44  +39  +35  +30  +26  +22  +18  +15  +12  +11  +10  +11  +12  +15  +18  +22  +26  +30  +35  +39  +44`));
            let greyField = GreyScale(samples,0,20);
            expect(Trim(greyField)).toEqual(Trim(`            
                |              ,,--======--,,              |
                |            ,,--++**##**++--,,            |
                |          ..--++##@@@@@@##++--..          |
                |          ,,==**@@@@@@@@@@**==,,          |
                |          ,,==##@@@@@@@@@@##==,,          |
                |          ,,==**@@@@@@@@@@**==,,          |
                |          ..--++##@@@@@@##++--..          |
                |            ,,--++**##**++--,,            |
                |              ,,--======--,,              |
                |                ..,,,,,,..                |
                |                                          |
                |                ..,,,,,,..                |
                |              ,,--======--,,              |
                |            ,,--++**##**++--,,            |
                |          ..--++##@@@@@@##++--..          |
                |          ,,==**@@@@@@@@@@**==,,          |
                |          ,,==##@@@@@@@@@@##==,,          |
                |          ,,==**@@@@@@@@@@**==,,          |
                |          ..--++##@@@@@@##++--..          |
                |            ,,--++**##**++--,,            |
                |              ,,--======--,,              |`));
            greyField = GreyScale(samples,-10,0);
            expect(Trim(greyField)).toEqual(Trim(`
                |                                          |
                |                                          |
                |                                          |
                |                  ::==::                  |
                |                  ==@@==                  |
                |                  ::==::                  |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                  ::==::                  |
                |                  ==@@==                  |
                |                  ::==::                  |
                |                                          |
                |                                          |
                |                                          |`));

        })     

        it('torus field on XZ plane', () => {
            const field = MakeSdfTorus(30,10);
            const samples = SampleFieldXz(100,100,5,field);
            const numField = NumScale(samples);
            expect(Trim(numField)).toEqual(Trim(`
                +31  +27  +24  +21  +18  +16  +14  +12  +11  +10  +10  +10  +11  +12  +14  +16  +18  +21  +24  +27  +31
                +27  +24  +20  +17  +14  +11  +09  +07  +06  +05  +05  +05  +06  +07  +09  +11  +14  +17  +20  +24  +27
                +24  +20  +17  +13  +10  +07  +05  +03  +01  +00  +00  +00  +01  +03  +05  +07  +10  +13  +17  +20  +24
                +21  +17  +13  +09  +06  +03  +00  -02  -04  -05  -05  -05  -04  -02  +00  +03  +06  +09  +13  +17  +21
                +18  +14  +10  +06  +02  -01  -04  -06  -08  -10  -10  -10  -08  -06  -04  -01  +02  +06  +10  +14  +18
                +16  +11  +07  +03  -01  -05  -08  -09  -07  -05  -05  -05  -07  -09  -08  -05  -01  +03  +07  +11  +16
                +14  +09  +05  +00  -04  -08  -08  -05  -02  -01  +00  -01  -02  -05  -08  -08  -04  +00  +05  +09  +14
                +12  +07  +03  -02  -06  -09  -05  -01  +02  +04  +05  +04  +02  -01  -05  -09  -06  -02  +03  +07  +12
                +11  +06  +01  -04  -08  -07  -02  +02  +06  +09  +10  +09  +06  +02  -02  -07  -08  -04  +01  +06  +11
                +10  +05  +00  -05  -10  -05  -01  +04  +09  +13  +15  +13  +09  +04  -01  -05  -10  -05  +00  +05  +10
                +10  +05  +00  -05  -10  -05  +00  +05  +10  +15  +20  +15  +10  +05  +00  -05  -10  -05  +00  +05  +10
                +10  +05  +00  -05  -10  -05  -01  +04  +09  +13  +15  +13  +09  +04  -01  -05  -10  -05  +00  +05  +10
                +11  +06  +01  -04  -08  -07  -02  +02  +06  +09  +10  +09  +06  +02  -02  -07  -08  -04  +01  +06  +11
                +12  +07  +03  -02  -06  -09  -05  -01  +02  +04  +05  +04  +02  -01  -05  -09  -06  -02  +03  +07  +12
                +14  +09  +05  +00  -04  -08  -08  -05  -02  -01  +00  -01  -02  -05  -08  -08  -04  +00  +05  +09  +14
                +16  +11  +07  +03  -01  -05  -08  -09  -07  -05  -05  -05  -07  -09  -08  -05  -01  +03  +07  +11  +16
                +18  +14  +10  +06  +02  -01  -04  -06  -08  -10  -10  -10  -08  -06  -04  -01  +02  +06  +10  +14  +18
                +21  +17  +13  +09  +06  +03  +00  -02  -04  -05  -05  -05  -04  -02  +00  +03  +06  +09  +13  +17  +21
                +24  +20  +17  +13  +10  +07  +05  +03  +01  +00  +00  +00  +01  +03  +05  +07  +10  +13  +17  +20  +24
                +27  +24  +20  +17  +14  +11  +09  +07  +06  +05  +05  +05  +06  +07  +09  +11  +14  +17  +20  +24  +27
                +31  +27  +24  +21  +18  +16  +14  +12  +11  +10  +10  +10  +11  +12  +14  +16  +18  +21  +24  +27  +31`));
            let greyField = GreyScale(samples,0,20);
            expect(Trim(greyField)).toEqual(Trim(`            
                |          ,,::----======----::,,          |
                |      ..::--==++**######**++==--::..      |
                |    ..::==**##%%@@@@@@@@@@%%##**==::..    |
                |  ..::==**%%@@@@@@@@@@@@@@@@@@%%**==::..  |
                |  ::==**%%@@@@@@@@@@@@@@@@@@@@@@%%**==::  |
                |,,--**%%@@@@@@@@@@@@@@@@@@@@@@@@@@%%**--,,|
                |::==##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##==::|
                |--++%%@@@@@@@@@@%%######%%@@@@@@@@@@%%++--|
                |--**@@@@@@@@@@%%**++==++**%%@@@@@@@@@@**--|
                |==##@@@@@@@@@@##++::,,::++##@@@@@@@@@@##==|
                |==##@@@@@@@@@@##==,,  ,,==##@@@@@@@@@@##==|
                |==##@@@@@@@@@@##++::,,::++##@@@@@@@@@@##==|
                |--**@@@@@@@@@@%%**++==++**%%@@@@@@@@@@**--|
                |--++%%@@@@@@@@@@%%######%%@@@@@@@@@@%%++--|
                |::==##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##==::|
                |,,--**%%@@@@@@@@@@@@@@@@@@@@@@@@@@%%**--,,|
                |  ::==**%%@@@@@@@@@@@@@@@@@@@@@@%%**==::  |
                |  ..::==**%%@@@@@@@@@@@@@@@@@@%%**==::..  |
                |    ..::==**##%%@@@@@@@@@@%%##**==::..    |
                |      ..::--==++**######**++==--::..      |
                |          ,,::----======----::,,          |`));
            greyField = GreyScale(samples,-10,0);
            expect(Trim(greyField)).toEqual(Trim(`
                |                                          |
                |                                          |
                |                                          |
                |              ,,::======::,,              |
                |          ..--**%%@@@@@@%%**--..          |
                |        ..==##@@**++==++**@@##==..        |
                |        --##%%==,,      ,,==%%##--        |
                |      ,,**@@==..          ..==@@**,,      |
                |      ::%%**,,              ,,**%%::      |
                |      ==@@++                  ++@@==      |
                |      ==@@==                  ==@@==      |
                |      ==@@++                  ++@@==      |
                |      ::%%**,,              ,,**%%::      |
                |      ,,**@@==..          ..==@@**,,      |
                |        --##%%==,,      ,,==%%##--        |
                |        ..==##@@**++==++**@@##==..        |
                |          ..--**%%@@@@@@%%**--..          |
                |              ,,::======::,,              |
                |                                          |
                |                                          |
                |                                          |`));

        })     

        it('cylinder field on XY plane', () => {
            const field = MakeSdfCylinder(40,30);
            const samples = SampleFieldXy(100,100,5,field);
            const numField = NumScale(samples);
            expect(Trim(numField)).toEqual(Trim(`
                +36  +34  +32  +30  +30  +30  +30  +30  +30  +30  +30  +30  +30  +30  +30  +30  +30  +30  +32  +34  +36
                +32  +29  +27  +25  +25  +25  +25  +25  +25  +25  +25  +25  +25  +25  +25  +25  +25  +25  +27  +29  +32
                +28  +25  +22  +21  +20  +20  +20  +20  +20  +20  +20  +20  +20  +20  +20  +20  +20  +21  +22  +25  +28
                +25  +21  +18  +16  +15  +15  +15  +15  +15  +15  +15  +15  +15  +15  +15  +15  +15  +16  +18  +21  +25
                +22  +18  +14  +11  +10  +10  +10  +10  +10  +10  +10  +10  +10  +10  +10  +10  +10  +11  +14  +18  +22
                +21  +16  +11  +07  +05  +05  +05  +05  +05  +05  +05  +05  +05  +05  +05  +05  +05  +07  +11  +16  +21
                +20  +15  +10  +05  +00  +00  +00  +00  +00  +00  +00  +00  +00  +00  +00  +00  +00  +05  +10  +15  +20
                +20  +15  +10  +05  +00  -05  -05  -05  -05  -05  -05  -05  -05  -05  -05  -05  +00  +05  +10  +15  +20
                +20  +15  +10  +05  +00  -05  -10  -10  -10  -10  -10  -10  -10  -10  -10  -05  +00  +05  +10  +15  +20
                +20  +15  +10  +05  +00  -05  -10  -15  -15  -15  -15  -15  -15  -15  -10  -05  +00  +05  +10  +15  +20
                +20  +15  +10  +05  +00  -05  -10  -15  -20  -20  -20  -20  -20  -15  -10  -05  +00  +05  +10  +15  +20
                +20  +15  +10  +05  +00  -05  -10  -15  -15  -15  -15  -15  -15  -15  -10  -05  +00  +05  +10  +15  +20
                +20  +15  +10  +05  +00  -05  -10  -10  -10  -10  -10  -10  -10  -10  -10  -05  +00  +05  +10  +15  +20
                +20  +15  +10  +05  +00  -05  -05  -05  -05  -05  -05  -05  -05  -05  -05  -05  +00  +05  +10  +15  +20
                +20  +15  +10  +05  +00  +00  +00  +00  +00  +00  +00  +00  +00  +00  +00  +00  +00  +05  +10  +15  +20
                +21  +16  +11  +07  +05  +05  +05  +05  +05  +05  +05  +05  +05  +05  +05  +05  +05  +07  +11  +16  +21
                +22  +18  +14  +11  +10  +10  +10  +10  +10  +10  +10  +10  +10  +10  +10  +10  +10  +11  +14  +18  +22
                +25  +21  +18  +16  +15  +15  +15  +15  +15  +15  +15  +15  +15  +15  +15  +15  +15  +16  +18  +21  +25
                +28  +25  +22  +21  +20  +20  +20  +20  +20  +20  +20  +20  +20  +20  +20  +20  +20  +21  +22  +25  +28
                +32  +29  +27  +25  +25  +25  +25  +25  +25  +25  +25  +25  +25  +25  +25  +25  +25  +25  +27  +29  +32
                +36  +34  +32  +30  +30  +30  +30  +30  +30  +30  +30  +30  +30  +30  +30  +30  +30  +30  +32  +34  +36`));
            let greyField = GreyScale(samples,0,20);
            expect(Trim(greyField)).toEqual(Trim(`
                |                                          |
                |                                          |
                |                                          |
                |    ..,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,..    |
                |  ..::--==========================--::..  |
                |  ,,--**##########################**--,,  |
                |  ,,==##@@@@@@@@@@@@@@@@@@@@@@@@@@##==,,  |
                |  ,,==##@@@@@@@@@@@@@@@@@@@@@@@@@@##==,,  |
                |  ,,==##@@@@@@@@@@@@@@@@@@@@@@@@@@##==,,  |
                |  ,,==##@@@@@@@@@@@@@@@@@@@@@@@@@@##==,,  |
                |  ,,==##@@@@@@@@@@@@@@@@@@@@@@@@@@##==,,  |
                |  ,,==##@@@@@@@@@@@@@@@@@@@@@@@@@@##==,,  |
                |  ,,==##@@@@@@@@@@@@@@@@@@@@@@@@@@##==,,  |
                |  ,,==##@@@@@@@@@@@@@@@@@@@@@@@@@@##==,,  |
                |  ,,==##@@@@@@@@@@@@@@@@@@@@@@@@@@##==,,  |
                |  ,,--**##########################**--,,  |
                |  ..::--==========================--::..  |
                |    ..,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,..    |
                |                                          |
                |                                          |
                |                                          |`));
            greyField = GreyScale(samples,-20,0);
            expect(Trim(greyField)).toEqual(Trim(`
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |          ,,,,,,,,,,,,,,,,,,,,,,          |
                |          ,,==================,,          |
                |          ,,==##############==,,          |
                |          ,,==##@@@@@@@@@@##==,,          |
                |          ,,==##############==,,          |
                |          ,,==================,,          |
                |          ,,,,,,,,,,,,,,,,,,,,,,          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |`));
        })     

        it('cylinder field on XZ plane', () => {
            const field = MakeSdfCylinder(40,30);
            const samples = SampleFieldXz(100,100,5,field);
            const numField = NumScale(samples);
            expect(Trim(numField)).toEqual(Trim(`
                +51  +47  +44  +41  +38  +36  +34  +32  +31  +30  +30  +30  +31  +32  +34  +36  +38  +41  +44  +47  +51
                +47  +44  +40  +37  +34  +31  +29  +27  +26  +25  +25  +25  +26  +27  +29  +31  +34  +37  +40  +44  +47
                +44  +40  +37  +33  +30  +27  +25  +23  +21  +20  +20  +20  +21  +23  +25  +27  +30  +33  +37  +40  +44
                +41  +37  +33  +29  +26  +23  +20  +18  +16  +15  +15  +15  +16  +18  +20  +23  +26  +29  +33  +37  +41
                +38  +34  +30  +26  +22  +19  +16  +14  +12  +10  +10  +10  +12  +14  +16  +19  +22  +26  +30  +34  +38
                +36  +31  +27  +23  +19  +15  +12  +09  +07  +05  +05  +05  +07  +09  +12  +15  +19  +23  +27  +31  +36
                +34  +29  +25  +20  +16  +12  +08  +05  +02  +01  +00  +01  +02  +05  +08  +12  +16  +20  +25  +29  +34
                +32  +27  +23  +18  +14  +09  +05  +01  -02  -04  -05  -04  -02  +01  +05  +09  +14  +18  +23  +27  +32
                +31  +26  +21  +16  +12  +07  +02  -02  -06  -09  -10  -09  -06  -02  +02  +07  +12  +16  +21  +26  +31
                +30  +25  +20  +15  +10  +05  +01  -04  -09  -13  -15  -13  -09  -04  +01  +05  +10  +15  +20  +25  +30
                +30  +25  +20  +15  +10  +05  +00  -05  -10  -15  -20  -15  -10  -05  +00  +05  +10  +15  +20  +25  +30
                +30  +25  +20  +15  +10  +05  +01  -04  -09  -13  -15  -13  -09  -04  +01  +05  +10  +15  +20  +25  +30
                +31  +26  +21  +16  +12  +07  +02  -02  -06  -09  -10  -09  -06  -02  +02  +07  +12  +16  +21  +26  +31
                +32  +27  +23  +18  +14  +09  +05  +01  -02  -04  -05  -04  -02  +01  +05  +09  +14  +18  +23  +27  +32
                +34  +29  +25  +20  +16  +12  +08  +05  +02  +01  +00  +01  +02  +05  +08  +12  +16  +20  +25  +29  +34
                +36  +31  +27  +23  +19  +15  +12  +09  +07  +05  +05  +05  +07  +09  +12  +15  +19  +23  +27  +31  +36
                +38  +34  +30  +26  +22  +19  +16  +14  +12  +10  +10  +10  +12  +14  +16  +19  +22  +26  +30  +34  +38
                +41  +37  +33  +29  +26  +23  +20  +18  +16  +15  +15  +15  +16  +18  +20  +23  +26  +29  +33  +37  +41
                +44  +40  +37  +33  +30  +27  +25  +23  +21  +20  +20  +20  +21  +23  +25  +27  +30  +33  +37  +40  +44
                +47  +44  +40  +37  +34  +31  +29  +27  +26  +25  +25  +25  +26  +27  +29  +31  +34  +37  +40  +44  +47
                +51  +47  +44  +41  +38  +36  +34  +32  +31  +30  +30  +30  +31  +32  +34  +36  +38  +41  +44  +47  +51`));
            let greyField = GreyScale(samples,0,20);
            expect(Trim(greyField)).toEqual(Trim(`
                |                                          |
                |                                          |
                |                                          |
                |              ....,,,,,,....              |
                |            ,,::--======--::,,            |
                |          ,,--==****##****==--,,          |
                |        ,,--++##%%@@@@@@%%##++--,,        |
                |      ..::==##@@@@@@@@@@@@@@##==::..      |
                |      ..--**%%@@@@@@@@@@@@@@%%**--..      |
                |      ,,==**@@@@@@@@@@@@@@@@@@**==,,      |
                |      ,,==##@@@@@@@@@@@@@@@@@@##==,,      |
                |      ,,==**@@@@@@@@@@@@@@@@@@**==,,      |
                |      ..--**%%@@@@@@@@@@@@@@%%**--..      |
                |      ..::==##@@@@@@@@@@@@@@##==::..      |
                |        ,,--++##%%@@@@@@%%##++--,,        |
                |          ,,--==****##****==--,,          |
                |            ,,::--======--::,,            |
                |              ....,,,,,,....              |
                |                                          |
                |                                          |
                |                                          |`));
            greyField = GreyScale(samples,-15,0);
            expect(Trim(greyField)).toEqual(Trim(`
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                ..::::::..                |
                |              ..--++**++--..              |
                |              ::++%%@@%%++::              |
                |              ::**@@@@@@**::              |
                |              ::++%%@@%%++::              |
                |              ..--++**++--..              |
                |                ..::::::..                |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |
                |                                          |`));
        })         
    })

}